source("~/bin/OliveTrees/OliveTree/R/OliveTree.R")
source("~/bin/OliveTrees/OliveTree/R/plotter.R")
# Figure_1A: Sand fly species tree
species_tree <- read_tree("Supplementary_File_4.Sandfly_species_tree.nwk")
# Figure_1B: Stacked barplots with orthogroup representation - Input is the orthology_results_for_R.txt produced by classify_orthogroups.pl
library(ggthemes)
orthology_counts <- read.delim("Supplementary_File_5.Orthology_results_for_ggplot.txt", header = T)
GST_tree <- visualize_tree(tree = "/home/jason/Documents/sandflies/Figures/Supplementary/gsts_with_hassan.nwk.tree")
GST_tree
GST_tree <- visualize_tree(tree = "/home/jason/Documents/sandflies/Figures/Supplementary/gsts_with_hassan.nwk.tree",
form = "circular",
color = group_colors,
shape = group_shapes,
references = c("AGAP","Hassan"))
# Color mappings for each sand fly species
group_colors <- c(arabicus = "purple",
argentipes =  "cyan",
duboscqi = "salmon2",
longipalpis = "darkgreen",
migonei =  "green",
orientalis =  "gold",
perniciosus =  "lightgreen",
papatasi =  "darkred",
schwetzi  = "blue",
sergenti =  "orange",
tobbi =  "red")
group_shapes <- c(arabicus = "circle",
argentipes = "circle",
duboscqi = "circle",
longipalpis = "square",
migonei = "square",
orientalis = "circle",
papatasi = "circle",
perniciosus = "circle",
schwetzi = "hexagonal star",
sergenti = "circle",
tobbi = "circle")
GST_tree <- visualize_tree(tree = "/home/jason/Documents/sandflies/Figures/Supplementary/gsts_with_hassan.nwk.tree",
form = "circular",
color = group_colors,
shape = group_shapes,
references = c("AGAP","Hassan"))
GST_tree
GST_tree <- visualize_tree(tree = "/home/jason/Documents/sandflies/Figures/Supplementary/gsts_with_hassan.nwk.tree",
form = "circular",
color = group_colors,
shape = group_shapes,
references = c("AGAP","Hassan"),
tip_shape_size = 2)
GST_tree
GST_tree <- visualize_tree(tree = "/home/jason/Documents/sandflies/Figures/Supplementary/gsts_with_hassan.nwk.tree",
form = "circular",
color = group_colors,
shape = group_shapes,
references = c("AGAP","Hassan"),
tip_shape_size = 2,
tip_label_size = 1.5)
GST_tree
GST_tree <- visualize_tree(tree = "/home/jason/Documents/sandflies/Figures/Supplementary/gsts_with_hassan.nwk.tree",
form = "circular",
color = group_colors,
shape = group_shapes,
references = c("AGAP","Hassan"),
tip_shape_size = 2,
tip_label_size = 1.5,
bootstrap_circle_size = 1)
GST_tree
GST_tree <- visualize_tree(tree = "/home/jason/Documents/sandflies/Figures/Supplementary/gsts_with_hassan.nwk",
form = "circular",
color = group_colors,
shape = group_shapes,
references = c("AGAP","Hassan"),
tip_shape_size = 2,
tip_label_size = 1.5,
bootstrap_circle_size = 1)
GST_tree
GST_tree <- visualize_tree(tree = "/home/jason/Documents/sandflies/Figures/Supplementary/gsts_with_hassan.nwk.tree",
form = "circular",
color = group_colors,
shape = group_shapes,
references = c("AGAP","Hassan"),
tip_shape_size = 2,
tip_label_size = 1.5,
bootstrap_circles = TRUE,
bootstrap_circle_size = 1)
GST_tree
# Figure_2A: P450 phylogeny with highlighted CYP clans
P450_tree <- read_tree("/home/jason/Documents/sandflies/submission/supplemental_information/Supplementary_Files/Supplementary_File_7.Sandfly_1275_P450s_plus_Agambiae.nwk", bootstrap_support = TRUE)
P450_tree@phylo$tip.label <- unlist(lapply(P450_tree@phylo$tip.label, function(x) {
gsub("^g", "longipalpis_g", x)
}))
P450_tree@phylo$tip.label <- unlist(lapply(P450_tree@phylo$tip.label, function(x) {
gsub("^Phlebotomus_papatasi", "papatasi", x)
}))
visualize_tree(P450_tree, color = group_colors, shape = group_shapes, form = "circular", references = "Agam")
# Figure_S4: Visualize P450 tree with reference tip labels (CYP names) from Ph. papatasi and An. gambiae
Figure_S4 <- visualize_tree(tree = P450_tree,
form = "circular",
color = group_colors,
shape = group_shapes,
references = c("papatasi", "Agam", "lutzomyia"),
tip_label_size = 2,
tip_shape_size = 0.8,
tip_label_colors = group_colors,
bootstrap_numbers = FALSE,
bootstrap_circles = TRUE,
bootstrap_circle_size = 0.7)
Figure_S4
# Figure_S4: Visualize P450 tree with reference tip labels (CYP names) from Ph. papatasi and An. gambiae
Figure_S4 <- visualize_tree(tree = P450_tree,
form = "circular",
color = group_colors,
shape = group_shapes,
references = c("papatasi", "lutzomyia"),
tip_label_size = 2,
tip_shape_size = 0.8,
tip_label_colors = group_colors,
bootstrap_numbers = FALSE,
bootstrap_circles = TRUE,
bootstrap_circle_size = 0.7)
Figure_S4
install.packages("rsvg")
---
title: "OliveTree: Advanced Phylogenetic Tree Visualization in R"
gc()
library(roxygen2)
roxygen2::roxygenize("~/bin/EvolSuite/OliveTRee/")
